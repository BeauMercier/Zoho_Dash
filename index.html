<!DOCTYPE html>
<html lang="en" data-theme="dark">
<head>
</head>
<body>
    <h1>Zoho iFrame Button Test</h1>
    <button onclick="sendMessageToZoho('https://leads.drasticdigital.com')">View Leads</button>
    <button id="drive-button" onclick="openDriveLink()" disabled>Open Google Drive</button>

    <script>
        let driveLink;

        function sendMessageToZoho(url) {
            window.parent.postMessage({ type: "openExternalLink", url: url }, "*");
        }

        function openDriveLink() {
            if (driveLink) {
                sendMessageToZoho(decodeURIComponent(driveLink));
            } else {
                console.error("Drive link not yet available.");
                alert("Drive link is not yet available. Please wait.");
            }
        }

        window.addEventListener("message", function(event) {
            if (event.data && event.data.type === "setDriveLink") {
                driveLink = event.data.link;
                console.log("Received Drive link (encoded):", driveLink);
                const decodedLink = decodeURIComponent(driveLink);
                console.log("Decoded Drive link:", decodedLink);
                document.getElementById("drive-button").disabled = false;
            }
        });

        window.addEventListener("error", (event) => {
            console.error("Iframe script error:", event);
            alert("A script error occurred in the dashboard. Please check the console for details.");
        });
    </script>
</body>
</html>
