<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Zoho iFrame Button Fix</title>
</head>
<body>

    <button id="drive-button">Open Google Drive</button>

    <script>
        function getDriveLink() {
            const urlParams = new URLSearchParams(window.location.search);
            let driveLink = urlParams.get("drive_link");

            if (driveLink && driveLink.trim() !== "" && driveLink.toLowerCase() !== "null") {
                if (driveLink.includes("embeddedfolderview?id=")) {
                    const folderId = driveLink.split("embeddedfolderview?id=")[1];
                    driveLink = "https://drive.google.com/drive/folders/" + folderId;
                }
                return driveLink;
            }
            return null;
        }

        document.getElementById("drive-button").addEventListener("click", function() {
            const driveLink = getDriveLink();
            if (driveLink) {
                // Create an anchor element dynamically and simulate a user click
                const a = document.createElement('a');
                a.href = driveLink;
                a.target = '_blank';
                a.rel = 'noopener noreferrer';
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
            } else {
                alert("No valid Google Drive link available.");
            }
        });
    </script>

</body>
</html>
