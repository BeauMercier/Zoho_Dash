<!DOCTYPE html>
<html lang="en" data-theme="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Zoho iFrame Button Test</title>
</head>
<body>
    <h1>Zoho iFrame Button Test</h1>
    <button onclick="sendMessageToZoho('https://leads.drasticdigital.com')">View Leads</button>
    <button id="drive-button" onclick="openDriveLink()">Open Google Drive</button>

    <script>
        let driveLink; // Do NOT initialize here. Let the message from Zoho set it.

        function sendMessageToZoho(url) {
            window.parent.postMessage({ type: "openExternalLink", url: url }, "*");
        }

        function openDriveLink() {
            if (driveLink) {
                sendMessageToZoho(driveLink);
            } else {
                console.error("Drive link not yet available.");
                alert("Drive link is not yet available. Please wait.");
            }
        }

        window.addEventListener("message", function(event) {
            if (event.data && event.data.type === "setDriveLink") {
                driveLink = event.data.link;
                console.log("Received Drive link:", driveLink);
                // Enable the Drive button now that we have the link
                document.getElementById("drive-button").disabled = false; 
            }
        });

        // Disable the Drive button initially until we receive the link
        document.getElementById("drive-button").disabled = true; 
    </script>
</body>
</html>
